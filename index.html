<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MyFilmPeople</title>
    <meta
      name="description"
      content="MyFilmPeople helps film enthusiasts follow their favorite directors, actors, and crew members. Discover new work, add personal notes, and more."
    />
    <meta
      name="keywords"
      content="film, directors, actors, crew, movies, filmmakers, Letterboxd, TMDb"
    />
    <meta name="author" content="MyFilmPeople Team" />

    <!-- Open Graph Meta Tags for Social Media -->
    <meta
      property="og:title"
      content="MyFilmPeople - Follow Your Favorite Filmmakers"
    />
    <meta
      property="og:description"
      content="Track your favorite directors, actors, and crew members. Discover their latest projects and add personal notes."
    />
    <meta property="og:url" content="https://myfilmpeople.netlify.app" />
    <meta property="og:type" content="website" />

    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta
      name="twitter:title"
      content="MyFilmPeople - Follow Your Favorite Filmmakers"
    />
    <meta
      name="twitter:description"
      content="Track your favorite directors, actors, and crew members. Discover their latest projects and add personal notes."
    />

    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=PT+Sans:ital,wght@0,400;0,700;1,400;1,700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="assets/css/styles.css?v=2025081905" />
    <link rel="icon" href="assets/images/favicon.ico" type="image/x-icon" />

    <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "WebSite",
        "name": "MyFilmPeople",
        "url": "https://myfilmpeople.netlify.app",
        "description": "MyFilmPeople helps film enthusiasts follow their favorite directors, actors, and crew members.",
        "potentialAction": {
          "@type": "SearchAction",
          "target": "https://myfilmpeople.netlify.app/search?q={search_term_string}",
          "query-input": "required name=search_term_string"
        }
      }
    </script>

    <script>
      // Function to dynamically update metadata
      function updateMetaTags(title, description, imageUrl) {
        document.title = title;

        const metaDescription = document.querySelector(
          'meta[name="description"]'
        );
        if (metaDescription)
          metaDescription.setAttribute("content", description);

        const ogTitle = document.querySelector('meta[property="og:title"]');
        if (ogTitle) ogTitle.setAttribute("content", title);

        const ogDescription = document.querySelector(
          'meta[property="og:description"]'
        );
        if (ogDescription) ogDescription.setAttribute("content", description);

        const ogImage = document.querySelector('meta[property="og:image"]');
        if (ogImage) ogImage.setAttribute("content", imageUrl);
      }

      // Example usage
      updateMetaTags(
        "MyFilmPeople",
        "Explore the filmography of your favorite director/actor."
      );
    </script>

    <!-- Google Analytics -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=GA_TRACKING_ID"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());
      gtag("config", "GA_TRACKING_ID");
    </script>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>MyFilmPeople</h1>
        <p>Letterboxd Movies Cast and Crew Following</p>
        
        <div class="header-actions">
          <button class="add-person-btn" id="addPersonBtn">Add Person</button>
          <button class="auth-btn secondary" id="showLoginBtn">Sign In</button>
        </div>
      </div>

      <div class="welcome-message">
        <h2>Welcome to MyFilmPeople!</h2>
        <p>Start by adding your favorite directors, actors, or crew members.</p>
      </div>

      <div class="content">
        <div class="tabs">
          <button class="tab-button active" data-tab="directors">
            Directors
          </button>
          <button class="tab-button" data-tab="actors">Actors</button>
          <button class="tab-button" data-tab="others">Others</button>
          <button class="tab-button" data-tab="companies">Companies</button>
        </div>

        <div id="directors-tab" class="tab-content active">
          <div class="header-with-controls">
            <div class="header-controls left">
              <div class="control-group">
                <button class="control-button" id="directorsSortButton">
                  ↕
                </button>
                <div class="sort-dropdown" id="directorsSortDropdown">
                  <div class="sort-option active" data-sort="alphabetical">
                    A-Z
                  </div>
                  <div class="sort-option" data-sort="reverse">Z-A</div>
                  <div class="sort-option" data-sort="random">Random Mix</div>
                </div>
              </div>
            </div>
            <h3>Directors</h3>
            <div class="header-controls right">
              <div class="control-group search-group">
                <button class="control-button" id="directorsSearchButton">
                  ⌕
                </button>
                <input
                  type="text"
                  class="search-input"
                  id="directorsSearch"
                  placeholder="Search directors..."
                />
              </div>
            </div>
          </div>
          <div class="directors-grid" id="directorsGrid">
            <!-- Directors will be populated by JavaScript -->
          </div>
        </div>

        <div id="actors-tab" class="tab-content">
          <div class="header-with-controls">
            <div class="header-controls left">
              <div class="control-group">
                <button class="control-button" id="actorsSortButton">↕</button>
                <div class="sort-dropdown" id="actorsSortDropdown">
                  <div class="sort-option active" data-sort="alphabetical">
                    A-Z
                  </div>
                  <div class="sort-option" data-sort="reverse">Z-A</div>
                  <div class="sort-option" data-sort="random">Random Mix</div>
                </div>
              </div>
            </div>
            <h3>Actors</h3>
            <div class="header-controls right">
              <div class="control-group search-group">
                <button class="control-button" id="actorsSearchButton">
                  ⌕
                </button>
                <input
                  type="text"
                  class="search-input"
                  id="actorsSearch"
                  placeholder="Search actors..."
                />
              </div>
            </div>
          </div>
          <div class="directors-grid" id="actorsGrid">
            <!-- Actors will be populated by JavaScript -->
          </div>
        </div>

        <div id="others-tab" class="tab-content">
          <div class="header-with-controls">
            <div class="header-controls left">
              <div class="control-group">
                <button class="control-button" id="othersSortButton">↕</button>
                <div class="sort-dropdown" id="othersSortDropdown">
                  <div class="sort-option active" data-sort="alphabetical">
                    A-Z
                  </div>
                  <div class="sort-option" data-sort="reverse">Z-A</div>
                  <div class="sort-option" data-sort="random">Random Mix</div>
                </div>
              </div>
            </div>
            <h3>Others</h3>
            <div class="header-controls right">
              <div class="control-group search-group">
                <button class="control-button" id="othersSearchButton">
                  ⌕
                </button>
                <input
                  type="text"
                  class="search-input"
                  id="othersSearch"
                  placeholder="Search others..."
                />
              </div>
            </div>
          </div>
          <div class="directors-grid" id="othersGrid">
            <!-- Others will be populated by JavaScript -->
          </div>
        </div>

        <div id="companies-tab" class="tab-content">
          <div class="header-with-controls">
            <div class="header-controls left">
              <div class="control-group">
                <button class="control-button" id="companiesSortButton">↕</button>
                <div class="sort-dropdown" id="companiesSortDropdown">
                  <div class="sort-option active" data-sort="alphabetical">A-Z</div>
                  <div class="sort-option" data-sort="reverse">Z-A</div>
                  <div class="sort-option" data-sort="random">Random Mix</div>
                </div>
              </div>
            </div>
            <h3>Companies</h3>
            <div class="header-controls right">
              <div class="control-group search-group">
                <button class="control-button" id="companiesSearchButton">⌕</button>
                <input
                  type="text"
                  class="search-input"
                  id="companiesSearch"
                  placeholder="Search companies..."
                />
              </div>
            </div>
          </div>
          <div class="directors-grid" id="companiesGrid">
            <!-- Companies will be populated by JavaScript -->
          </div>
        </div>
      </div>

      <!-- Add Person Modal -->
      <div id="addPersonModal" class="modal">
        <div class="modal-content">
          <div class="modal-header">
            <h2>Add New Person</h2>
            <span class="close" id="closeModal">&times;</span>
          </div>
          <form id="addPersonForm">
            <div class="form-group">
              <label for="personSearch">Search Person</label>
              <div class="search-container">
                <input
                  type="text"
                  id="personSearch"
                  placeholder="Enter the correct spelling"
                />
                <div id="searchResults" class="search-results"></div>
              </div>
            </div>

            <div class="form-group">
              <label for="manualTmdbId">Manual TMDb ID (Optional)</label>
              <div class="input-with-dropdown">
                <input
                  type="number"
                  id="manualTmdbId"
                  placeholder="e.g., 525 for Christopher Nolan"
                  min="1"
                />
                <div class="custom-dropdown" id="tmdbTypeSelector">
                  <div class="custom-dropdown-trigger">
                    <span>Person</span>
                    <span class="dropdown-arrow">▼</span>
                  </div>
                  <div class="custom-dropdown-options">
                    <div class="custom-option" data-value="person">Person</div>
                    <div class="custom-option" data-value="company">Company</div>
                  </div>
                </div>
              </div>
              <small class="form-help">
                If search gives wrong person, find the correct TMDb ID from
                themoviedb.org and enter it here.<br />
                Example: For Christopher Nolan, the URL is
                themoviedb.org/person/525, so enter "525"
              </small>
            </div>

            <div class="form-group">
              <label for="personName">Name *</label>
              <input
                type="text"
                id="personName"
                required
                placeholder="e.g., Christopher Nolan"
              />
            </div>

            <div class="form-group">
              <label for="profilePictureUrl">Profile Picture URL</label>
              <div class="input-with-button">
                <input
                  type="url"
                  id="profilePictureUrl"
                  placeholder="https://example.com/image.jpg"
                  class="flex-input"
                />
                <button
                  type="button"
                  id="searchImageBtn"
                  class="control-button"
                  title="Search for images"
                >
                  🔍
                </button>
              </div>
              <small class="form-help">
                Try these sources that work if TMDB doesn't works:<br />
                • IMDb images<br />
                • Google Images (copy image address)<br />
                • Any direct image URL
              </small>
            </div>

            <div class="form-group">
              <label for="personRole">Role *</label>
              <div class="custom-select-wrapper">
                <div class="custom-select" id="personRoleSelect">
                  <div class="custom-select-trigger">
                    <span class="custom-select-text">Select role...</span>
                    <span class="custom-select-arrow">▼</span>
                  </div>
                  <div class="custom-select-options">
                    <div class="custom-option" data-value="">
                      Select role...
                    </div>
                    <div class="custom-option" data-value="director">
                      Director
                    </div>
                    <div class="custom-option" data-value="actor">Actor</div>
                    <div class="custom-option" data-value="writer">Writer</div>
                    <div class="custom-option" data-value="cinematographer">
                      Cinematographer
                    </div>
                    <div class="custom-option" data-value="composer">
                      Composer
                    </div>
                    <div class="custom-option" data-value="producer">
                      Producer
                    </div>
                    <div class="custom-option" data-value="editor">Editor</div>
                    <div class="custom-option" data-value="studio">Studio</div>
                    <div class="custom-option" data-value="other">Other</div>
                  </div>
                </div>
                <input
                  type="hidden"
                  id="personRole"
                  name="personRole"
                  required
                />
              </div>
            </div>

            <div class="form-group">
              <label for="letterboxdUrl">Letterboxd URL</label>
              <input
                type="url"
                id="letterboxdUrl"
                placeholder="https://letterboxd.com/director/christopher-nolan/"
              />
              <small class="form-help">
                Auto-filled URL may not be correct for people with same
                names.<br />
                Check letterboxd.com to find the correct person's URL and update
                the slug if needed.<br />
                Format: https://letterboxd.com/role/name-slug/
              </small>
            </div>

            <div class="form-group">
              <label for="notes">Personal Notes</label>
              <textarea
                id="notes"
                placeholder="Your thoughts, favorite films, etc."
              ></textarea>
            </div>

            <div class="form-actions">
              <button type="button" id="cancelBtn">Cancel</button>
              <button type="submit" id="submitBtn">Add Person</button>
            </div>
          </form>
        </div>
      </div>
    </div>

    <!-- Authentication Modal -->
    <div id="authModal" class="modal hidden">
      <div class="modal-content auth-modal">
        <div class="modal-header">
          <h2 id="authModalTitle">Sign In to MyFilmPeople</h2>
          <button id="authModalClose" class="close-btn">&times;</button>
        </div>
        
        <div id="authError" class="auth-message error hidden"></div>
        
        <!-- Login Form -->
        <div id="loginFormContainer" class="auth-form-container">
          <form id="loginForm" class="auth-form">
            <div class="form-group">
              <label for="loginEmail">Email</label>
              <input type="email" id="loginEmail" required>
            </div>
            <div class="form-group">
              <label for="loginPassword">Password</label>
              <input type="password" id="loginPassword" required>
            </div>
            <button type="submit" id="loginSubmitBtn" class="auth-submit-btn">Sign In</button>
          </form>
          
          <div class="auth-divider">
            <span>or</span>
          </div>
          
          <button id="googleSignInBtn" class="google-btn">
            <span class="google-icon">G</span>
            Continue with Google
          </button>
          
          <p class="auth-switch">
            Don't have an account? 
            <a href="#" id="switchToRegister">Sign up free</a>
          </p>
        </div>
        
        <!-- Register Form -->
        <div id="registerFormContainer" class="auth-form-container hidden">
          <form id="registerForm" class="auth-form">
            <div class="form-group">
              <label for="registerDisplayName">Name (optional)</label>
              <input type="text" id="registerDisplayName" placeholder="Your name">
            </div>
            <div class="form-group">
              <label for="registerEmail">Email</label>
              <input type="email" id="registerEmail" required>
            </div>
            <div class="form-group">
              <label for="registerPassword">Password</label>
              <input type="password" id="registerPassword" required minlength="6">
            </div>
            <div class="form-group">
              <label for="registerConfirmPassword">Confirm Password</label>
              <input type="password" id="registerConfirmPassword" required minlength="6">
            </div>
            <button type="submit" id="registerSubmitBtn" class="auth-submit-btn">Create Account</button>
          </form>
          
          <div class="auth-divider">
            <span>or</span>
          </div>
          
          <button id="googleSignInRegisterBtn" class="google-btn">
            <span class="google-icon">G</span>
            Continue with Google
          </button>
          
          <p class="auth-switch">
            Already have an account? 
            <a href="#" id="switchToLogin">Sign in</a>
          </p>
        </div>
        
        <div class="auth-benefits">
          <h4>Why sign up?</h4>
          <ul>
            <li>☁️ Sync your data across devices</li>
            <li>🔒 Never lose your collection</li>
            <li>📱 Access from anywhere</li>
            <li>🆓 Always free</li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Logout Confirmation Modal -->
    <div id="logoutModal" class="modal hidden">
      <div class="modal-content auth-modal">
        <div class="modal-header">
          <h2>Sign Out</h2>
          <button id="logoutModalClose" class="close-btn">&times;</button>
        </div>
        
        <div class="modal-body">
          <p class="logout-message">
            Are you sure you want to sign out?<br>
            <small>Your data is safely stored and will be available when you sign back in.</small>
          </p>
        </div>
        
        <div class="modal-footer logout-footer">
          <button id="logoutCancel" class="btn-secondary">
            Cancel
          </button>
          <button id="logoutConfirm" class="btn-danger">
            Sign Out
          </button>
        </div>
      </div>
    </div>

    <footer class="app-footer">
      <p>
        © 2025 MyFilmPeople. Film data from TMDb. Made with ❤️ for film lovers
        and letterboxd users
      </p>
    </footer>

    <!-- Configuration scripts -->
    <script src="assets/js/env.netlify.js"></script>
    <script src="assets/js/config.local.js" onerror="console.log('No local config - using environment or production config')"></script>
    <script src="assets/js/config.js"></script>
    
    <!-- Main app script (works independently) -->
    <script src="assets/js/script.js"></script>
    
    <!-- Firebase authentication (safe loading) -->
    <script>
      // Wait for main app, then load Firebase safely
      document.addEventListener('DOMContentLoaded', function() {
        setTimeout(async function() {
          if (!window.uiManager || !document.getElementById('addPersonBtn')) {
            console.log('⚠️ Main app not ready, skipping Firebase');
            return;
          }
          
          console.log('✅ Main app working, loading Firebase...');
          
          try {
            // Load Firebase modules
            await import('./assets/js/firebase-auth.js');
            console.log('✅ Firebase authentication loaded');
          } catch (error) {
            console.log('📱 Firebase not available:', error.message);
          }
        }, 2000);
      });
    </script>
  </body>
</html>
